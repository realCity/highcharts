/*
 Highstock JS v4.2.5-modified ()
 Client side exporting module

 (c) 2015 Torstein Honsi / Oystein Moseng

 License: www.highcharts.com/license
*/
(function(a){typeof module==="object"&&module.exports?module.exports=a:a(Highcharts)})(function(a){function s(h,a){var c=m.getElementsByTagName("head")[0],b=m.createElement("script");b.type="text/javascript";b.src=h;b.onload=a;c.appendChild(b)}var f=a.win,d=f.navigator,m=f.document,o=f.URL||f.webkitURL||f;a.CanVGRenderer={};a.downloadURL=function(h,a){var c=m.createElement("a"),b;if(d.msSaveOrOpenBlob)d.msSaveOrOpenBlob(h,a);else if(c.download!==void 0)c.href=h,c.download=a,c.target="_blank",m.body.appendChild(c),
c.click(),m.body.removeChild(c);else try{if(b=f.open(h,"chart"),b===void 0||b===null)throw"Failed to open window";}catch(l){f.location.href=h}};a.svgToDataUrl=function(a){var j=d.userAgent.indexOf("WebKit")>-1&&d.userAgent.indexOf("Chrome")<0;try{if(!j&&d.userAgent.toLowerCase().indexOf("firefox")<0)return o.createObjectURL(new f.Blob([a],{type:"image/svg+xml;charset-utf-16"}))}catch(c){}return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(a)};a.imageToDataUrl=function(a,j,c,b,l,g,k,i,n){var e=
new f.Image,p,d=function(){var g=m.createElement("canvas"),i=g.getContext&&g.getContext("2d"),f;try{if(i){g.height=e.height*b;g.width=e.width*b;i.drawImage(e,0,0,g.width,g.height);try{f=g.toDataURL(j),l(f,j,c,b)}catch(d){if(d.name==="SecurityError"||d.name==="SECURITY_ERR"||d.message==="SecurityError")p(a,j,c,b);else throw d;}}else k(a,j,c,b)}finally{n&&n(a,j,c,b)}},q=function(){i(a,j,c,b);n&&n(a,j,c,b)};p=function(){e=new f.Image;p=g;e.crossOrigin="Anonymous";e.onload=d;e.onerror=q;e.src=a};e.onload=
d;e.onerror=q;e.src=a};a.downloadSVGLocal=function(h,j,c,b,l,g){var k,i;if(c==="image/svg+xml")try{d.msSaveOrOpenBlob?(i=new MSBlobBuilder,i.append(h),k=i.getBlob("image/svg+xml")):k=a.svgToDataUrl(h),a.downloadURL(k,j),g&&g()}catch(n){l()}else k=a.svgToDataUrl(h),a.imageToDataUrl(k,c,{},b,function(b){try{a.downloadURL(b,j),g&&g()}catch(c){l()}},function(){var e=m.createElement("canvas"),k=e.getContext("2d"),i=h.match(/^<svg[^>]*width\s*=\s*\"?(\d+)\"?[^>]*>/)[1]*b,n=h.match(/^<svg[^>]*height\s*=\s*\"?(\d+)\"?[^>]*>/)[1]*
b,r=function(){k.drawSvg(h,0,0,i,n);try{a.downloadURL(d.msSaveOrOpenBlob?e.msToBlob():e.toDataURL(c),j),g&&g()}catch(b){l()}};e.width=i;e.height=n;f.canvg?r():s(a.getOptions().global.canvasToolsURL,function(){r()})},l,l,function(){try{o.revokeObjectURL(k)}catch(a){}})};a.Chart.prototype.getSVGForLocalExport=function(h,j,c,b){var d=this,g,k=0,i,f,e,m,o=function(a,c,e){++k;e.imageElement.setAttributeNS("http://www.w3.org/1999/xlink","href",a);k===g.length&&b(d.sanitizeSVG(i.innerHTML))};a.wrap(a.Chart.prototype,
"getChartHTML",function(a){i=this.container.cloneNode(!0);return a.apply(this,Array.prototype.slice.call(arguments,1))});d.getSVGForExport(h,j);g=i.getElementsByTagName("image");try{if(g.length)for(e=0,m=g.length;e<m;++e)f=g[e],a.imageToDataUrl(f.getAttributeNS("http://www.w3.org/1999/xlink","href"),"image/png",{imageElement:f},h.scale,o,c,c,c);else b(d.sanitizeSVG(i.innerHTML))}catch(q){c()}};a.Chart.prototype.exportChartLocal=function(d,f){var c=this,b=a.merge(c.options.exporting,d),l=function(){if(b.fallbackToExportServer===
!1)if(b.error)b.error();else throw"Fallback to export server disabled";else c.exportChart(b)};c.getSVGForLocalExport(b,f,l,function(c){var d=b&&b.type||"image/png",f=(b.filename||"chart")+"."+(d==="image/svg+xml"?"svg":d.split("/")[1]);a.downloadSVGLocal(c,f,d,b.scale,l)})};a.getOptions().exporting.buttons.contextButton.menuItems=[{textKey:"printChart",onclick:function(){this.print()}},{separator:!0},{textKey:"downloadPNG",onclick:function(){this.exportChartLocal()}},{textKey:"downloadJPEG",onclick:function(){this.exportChartLocal({type:"image/jpeg"})}},
{textKey:"downloadSVG",onclick:function(){this.exportChartLocal({type:"image/svg+xml"})}}]});
